"0","# Prepare the dataset with the new top features"
"0","data_top_features <- data[, c(""price_dist"", ""engine_size"", ""horsepower"", ""milage"", ""model"", ""price"")]"
"0",""
"0","# Encode the `model` variable as numeric"
"0","data_top_features$model_encoded <- as.numeric(factor(data_top_features$model))"
"0",""
"0","# Convert categorical variables to factors"
"0","data_top_features$price_dist <- as.factor(data_top_features$price_dist)"
"0",""
"0","# Split the data into training and testing sets"
"0","set.seed(123)"
"0","train_index <- createDataPartition(data_top_features$price, p = 0.8, list = FALSE)"
"0","train_data <- data_top_features[train_index, ]"
"0","test_data <- data_top_features[-train_index, ]"
"0",""
"0","# Train a Random Forest regression model"
"0","set.seed(123)"
"0","rf_model <- randomForest("
"0","  price ~ price_dist + engine_size + horsepower + milage + model_encoded,"
"0","  data = train_data,"
"0","  ntree = 500,"
"0","  importance = TRUE"
"0",")"
"0",""
"0","# Identify model codes for selected cars"
"0","code_Q50_Hybrid_Sport <- which(levels(factor(data_top_features$model)) == ""Q50 Hybrid Sport"")"
"0","code_Utility_Police <- which(levels(factor(data_top_features$model)) == ""Utility Police Interceptor Base"")"
"0","code_S3 <- which(levels(factor(data_top_features$model)) == ""S3 2.0T Premium Plus"")"
"0",""
"0","# Selected cars"
"0","selected_cars <- data.frame("
"0","  price_dist = factor(c(""$12,000 - $21,999"", ""< $12,000"", ""$32,000 - $49,999""),"
"0","                      levels = levels(data_top_features$price_dist)),"
"0","  engine_size = c(3.5, 3.7, 2.0),"
"0","  horsepower = c(354, 300, 292),"
"0","  milage = c(0, 0, 0), # Hypothetical new car mileage"
"0","  model_encoded = c(code_Q50_Hybrid_Sport, code_Utility_Police, code_S3)"
"0",")"
"0",""
"0","# Predict prices for the selected cars as if they were new"
"0","predicted_prices <- predict(rf_model, newdata = selected_cars)"
"0",""
"0","# Add original prices for comparison"
"0","selected_cars$model <- c(""Q50 Hybrid Sport"", ""Utility Police Interceptor Base"", ""S3 2.0T Premium Plus"")"
"0","selected_cars$predicted_price <- predicted_prices"
"0","selected_cars$original_price <- c(44400, 29100, 51325) # Replace with actual new prices"
"0",""
"0","# Calculate discrepancies"
"0","selected_cars$discrepancy <- selected_cars$original_price - selected_cars$predicted_price"
"0",""
"0","# Print the results"
"0","print(selected_cars)"

"0",""
"0","#Select first 2 components for clustering"
"0","pca_data <- as.data.frame(pca_result$x[, 1:2])"
"0",""
"0","#Step 3: Determine Optimal Number of Clusters for K-Means"
"0","#3.1 Silhouette Method"
"0","sil_scores <- numeric()"
"0","for (k in 2:10) {"
"0","  set.seed(123)"
"0","  kmeans_result <- stats::kmeans(pca_data, centers = k, nstart = 25)"
"0","  sil_scores[k] <- mean(silhouette(kmeans_result$cluster, dist(pca_data))[, 3])"
"0","}"
"0","plot(2:10, sil_scores[2:10], type = ""b"", pch = 19,"
"0","     xlab = ""Number of Clusters"", "
"0","     ylab = ""Average Silhouette Width"", "
"0","     main = ""Silhouette Method for Optimal Clusters"")"
